<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: doLouvainSubCluster</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for doLouvainSubCluster {Giotto}"><tr><td>doLouvainSubCluster {Giotto}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>doLouvainSubCluster</h2>

<h3>Description</h3>

<p>subcluster cells using a NN-network and the Louvain algorithm
</p>


<h3>Usage</h3>

<pre>
doLouvainSubCluster(
  gobject,
  name = "sub_louvain_clus",
  version = c("community", "multinet"),
  cluster_column = NULL,
  selected_clusters = NULL,
  hvg_param = list(reverse_log_scale = T, difference_in_variance = 1, expression_values
    = "normalized"),
  hvg_min_perc_cells = 5,
  hvg_mean_expr_det = 1,
  use_all_genes_as_hvg = FALSE,
  min_nr_of_hvg = 5,
  pca_param = list(expression_values = "normalized", scale_unit = T),
  nn_param = list(dimensions_to_use = 1:20),
  k_neighbors = 10,
  resolution = 0.5,
  gamma = 1,
  omega = 1,
  python_path = NULL,
  nn_network_to_use = "sNN",
  network_name = "sNN.pca",
  return_gobject = TRUE,
  verbose = T
)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>gobject</code></td>
<td>
<p>giotto object</p>
</td></tr>
<tr valign="top"><td><code>name</code></td>
<td>
<p>name for new clustering result</p>
</td></tr>
<tr valign="top"><td><code>version</code></td>
<td>
<p>version of Louvain algorithm to use</p>
</td></tr>
<tr valign="top"><td><code>cluster_column</code></td>
<td>
<p>cluster column to subcluster</p>
</td></tr>
<tr valign="top"><td><code>selected_clusters</code></td>
<td>
<p>only do subclustering on these clusters</p>
</td></tr>
<tr valign="top"><td><code>hvg_param</code></td>
<td>
<p>parameters for calculateHVG</p>
</td></tr>
<tr valign="top"><td><code>hvg_min_perc_cells</code></td>
<td>
<p>threshold for detection in min percentage of cells</p>
</td></tr>
<tr valign="top"><td><code>hvg_mean_expr_det</code></td>
<td>
<p>threshold for mean expression level in cells with detection</p>
</td></tr>
<tr valign="top"><td><code>use_all_genes_as_hvg</code></td>
<td>
<p>forces all genes to be HVG and to be used as input for PCA</p>
</td></tr>
<tr valign="top"><td><code>min_nr_of_hvg</code></td>
<td>
<p>minimum number of HVG, or all genes will be used as input for PCA</p>
</td></tr>
<tr valign="top"><td><code>pca_param</code></td>
<td>
<p>parameters for runPCA</p>
</td></tr>
<tr valign="top"><td><code>nn_param</code></td>
<td>
<p>parameters for parameters for createNearestNetwork</p>
</td></tr>
<tr valign="top"><td><code>k_neighbors</code></td>
<td>
<p>number of k for createNearestNetwork</p>
</td></tr>
<tr valign="top"><td><code>resolution</code></td>
<td>
<p>resolution for community algorithm</p>
</td></tr>
<tr valign="top"><td><code>gamma</code></td>
<td>
<p>gamma</p>
</td></tr>
<tr valign="top"><td><code>omega</code></td>
<td>
<p>omega</p>
</td></tr>
<tr valign="top"><td><code>python_path</code></td>
<td>
<p>specify specific path to python if required</p>
</td></tr>
<tr valign="top"><td><code>nn_network_to_use</code></td>
<td>
<p>type of NN network to use (kNN vs sNN)</p>
</td></tr>
<tr valign="top"><td><code>network_name</code></td>
<td>
<p>name of NN network to use</p>
</td></tr>
<tr valign="top"><td><code>return_gobject</code></td>
<td>
<p>boolean: return giotto object (default = TRUE)</p>
</td></tr>
<tr valign="top"><td><code>verbose</code></td>
<td>
<p>verbose</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function performs subclustering using the Louvain algorithm on selected clusters.
The systematic steps are:
</p>

<ul>
<li><p>1. subset Giotto object
</p>
</li>
<li><p>2. identify highly variable genes
</p>
</li>
<li><p>3. run PCA
</p>
</li>
<li><p>4. create nearest neighbouring network
</p>
</li>
<li><p>5. do Louvain clustering
</p>
</li></ul>



<h3>Value</h3>

<p>giotto object with new subclusters appended to cell metadata
</p>


<h3>See Also</h3>

<p><code>doLouvainCluster_multinet</code> and <code>doLouvainCluster_community</code>
</p>


<h3>Examples</h3>

<pre>
    doLouvainSubCluster(gobject)
</pre>

<hr /><div style="text-align: center;">[Package <em>Giotto</em> version 0.1.4 ]</div>
</body></html>
